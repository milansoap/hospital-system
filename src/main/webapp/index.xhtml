<!DOCTYPE html>
<html
        xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
        xmlns:h="http://xmlns.jcp.org/jsf/html"
        xmlns:f="http://xmlns.jcp.org/jsf/core"
        xmlns:jsf="http://xmlns.jcp.org/jsf"
>

<h:head>
    <meta charset="UTF-8"/>
    <title><ui:insert name="title">AIV</ui:insert></title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"/>

    <ui:include src="navbar.xhtml" />
</h:head>


<h:body>


    <div id="content" class="m-5">
        <ui:insert name="content">

            <h:panelGroup rendered="#{app.showDoctorForm}">


                <h:form>

                    <h1 class="text-center">DOCTOR</h1>
                    <div class="form-group">
                        <h:outputLabel for="doctorsName" value="Enter doctor's name:"/>
                        <h:inputText id="doctorsName" class="form-control" value="#{app.insertedDoctor.name}"/>
                    </div>

                    <div class="form-group">
                        <h:outputLabel for="doctorsSurname" value="Enter doctor's surname"/>
                        <h:inputText id="doctorsSurname" class="form-control" value="#{app.insertedDoctor.surname}"/>
                    </div>

                    <div class="form-group">
                        <h:outputLabel for="doctorsEmail" value="Enter doctor's e-mail"/>
                        <h:inputText id="doctorsEmail" class="form-control" value="#{app.insertedDoctor.email}"/>
                    </div>

                    <h:commandButton class="btn btn-primary" value="Add Doctor" actionListener="#{app.addDoctor}"/>
                    <h:commandButton class="btn btn-primary" value="Switch mode" actionListener="#{app.switchMode}"/>
                </h:form>

                <h1 class="text-center mb-2">DISPLAYING DOCTORS</h1>


                <h:form>
                    <h:dataTable value="#{app.getAllDoctors()}" var="doctor" class="table" editable="true">
                        <h:column>
                            <f:facet name="header"> Name </f:facet>
                            <h:outputText value="#{doctor.name}" rendered="#{!doctor.editable}"/>
                            <h:inputText value="#{doctor.name}" rendered="#{doctor.editable}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header"> Surname </f:facet>

                            <h:outputText value="#{doctor.surname}" rendered="#{!doctor.editable}"/>
                            <h:inputText value="#{doctor.surname}" rendered="#{doctor.editable}"/>

                        </h:column>
                        <h:column>
                            <f:facet name="header"> Email </f:facet>

                            <h:outputText value="#{doctor.email}" rendered="#{!doctor.editable}"/>
                            <h:inputText value="#{doctor.email}" rendered="#{doctor.editable}"/>


                        </h:column>
                        <h:column>
                            <f:facet name="header"> Number of patients </f:facet>

                            <h:outputText value="#{app.getNum(doctor)}" rendered="#{!doctor.editable}"/>

                        </h:column>
                        <h:column>
                            <f:facet name="header"> Delete </f:facet>
                            <h:commandButton styleClass="btn btn-danger" value="DELETE"
                                             onclick="if(!confirm('Are you sure you want to delete this doctor?')){return false;}"
                                             actionListener="#{app.deleteDoctor(doctor)}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header"> Update </f:facet>
                            <h:commandButton styleClass="btn btn-warning" value="UPDATE"
                                             rendered="#{!doctor.editable}"
                                             actionListener="#{app.enableEditing(doctor)}"/>
                            <h:commandButton styleClass="btn btn-warning" value="SAVE EDIT"
                                             rendered="#{doctor.editable}"
                                             actionListener="#{app.saveEditing(doctor)}"/>
                        </h:column>


                    </h:dataTable>
                </h:form>
            </h:panelGroup>


            <h:panelGroup rendered="#{app.showPatientForm}">

                <h:form>
                    <h1 class="text-center">PACIENTS</h1>
                    <div class="form-group">
                        <h:outputLabel for="pacientName" value="Enter pacient's name:"/>
                        <h:inputText id="pacientName" class="form-control" value="#{app.insertedPacient.name}"/>
                    </div>

                    <div class="form-group">
                        <h:outputLabel for="pacientSurname" value="Enter pacient's surname"/>
                        <h:inputText id="pacientSurname" class="form-control" value="#{app.insertedPacient.surname}"/>
                    </div>

                    <div class="form-group">
                        <h:outputLabel for="pacientEmail" value="Enter pacient's e-mail"/>
                        <h:inputText id="pacientEmail" class="form-control" value="#{app.insertedPacient.email}"/>
                    </div>

                    <div class="form-group">
                        <h:outputLabel for="pacientBirth" value="Enter pacient's date of birth in format (yyyy-MM-dd)"/>
                        <h:inputText id="pacientBirth" class="form-control" value="#{app.insertedPacient.dateOfBirth}"
                                     type="date">
                            <f:convertDateTime pattern="yyyy-MM-dd"/>
                        </h:inputText>
                    </div>

                    <div class="form-group">
                        <h:outputLabel for="pacientCharacteristics" value="Enter pacient characteristics"/>
                        <h:inputText id="pacientCharacteristics" class="form-control"
                                     value="#{app.insertedPacient.characteristics}"/>
                    </div>


                    <div class="form-group">

                        <h:selectOneMenu value="#{app.selectedDoctor}" converter="doctorConverter">
                            <f:selectItem itemLabel="-- Select Doctor --" itemValue=""/>
                            <f:selectItems value="#{app.getAllDoctors()}" var="doctor" itemValue="#{doctor}"
                                           itemLabel="#{doctor.name} #{doctor.surname}"/>
                            <f:ajax execute="@form" listener="#{app.updateSelectedDoctor}" />
                        </h:selectOneMenu>


                    </div>


                    <h:commandButton class="btn btn-primary" value="Add pacient" actionListener="#{app.addPacient()}"/>
                    <h:commandButton class="btn btn-primary" value="Switch mode" actionListener="#{app.switchMode}"/>

                </h:form>


                <h1 class="text-center mb-2">DISPLAYING PACIENTS</h1>
                <h:form>
                    <h:dataTable value="#{app.getAllPacients()}" var="pacient" class="table">
                        <h:column>
                            <f:facet name="header"> Name </f:facet>

                            <h:outputText value="#{pacient.name}" rendered="#{!pacient.editable}"/>
                            <h:inputText value="#{pacient.name}" rendered="#{pacient.editable}"/>

                        </h:column>
                        <h:column>
                            <f:facet name="header"> Surname </f:facet>
                            <h:outputText value="#{pacient.surname}" rendered="#{!pacient.editable}"/>
                            <h:inputText value="#{pacient.surname}" rendered="#{pacient.editable}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header"> Email </f:facet>
                            <h:outputText value="#{pacient.email}" rendered="#{!pacient.editable}"/>
                            <h:inputText value="#{pacient.email}" rendered="#{pacient.editable}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header"> Pacient's date of birth </f:facet>
                            <h:outputText value="#{pacient.dateOfBirth}" rendered="#{!pacient.editable}"/>
                            <h:inputText type="date" value="#{pacient.dateOfBirth}" rendered="#{pacient.editable}">
                                <f:convertDateTime pattern="yyyy-MM-dd"/>
                            </h:inputText>
                        </h:column>

                        <h:column>
                            <f:facet name="header"> Pacient Characteristic </f:facet>
                            <h:outputText value="#{pacient.characteristics}" rendered="#{!pacient.editable}"/>
                            <h:inputText value="#{pacient.characteristics}" rendered="#{pacient.editable}"/>
                        </h:column>

                        <h:column>
                            <f:facet name="header"> Pacient's doctor </f:facet>
                            #{pacient.doctor.name} #{pacient.doctor.surname}

                        </h:column>


                        <h:column>
                            <f:facet name="header"> Delete </f:facet>
                            <h:commandButton styleClass="btn btn-danger" value="DELETE"
                                             onclick="if(!confirm('Are you sure you want to delete this pacient?')){return false;}"
                                             actionListener="#{app.deletePacient(pacient)}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header"> Update </f:facet>
                            <h:commandButton styleClass="btn btn-warning" value="UPDATE"
                                             rendered="#{!pacient.editable}"
                                             actionListener="#{app.enableEditingPacient(pacient)}"/>
                            <h:commandButton styleClass="btn btn-warning" value="SAVE EDIT"
                                             rendered="#{pacient.editable}"
                                             actionListener="#{app.saveEditingPacient(pacient)}"/>
                        </h:column>


                    </h:dataTable>

                </h:form>
            </h:panelGroup>
        </ui:insert>
    </div>


    <!-- Include Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>


</h:body>

</html>








